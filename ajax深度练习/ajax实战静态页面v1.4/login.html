<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>登录</title>
    <link rel="stylesheet" href="./css/login.css">
</head>

<body>
    <div class="lowin">
        <div class="lowin-brand">
            <img src="./img/kodinger.jpg" alt="logo">
        </div>
        <div class="lowin-wrapper">
            <div class="lowin-box lowin-login">
                <div class="lowin-box-inner">
                    <form id="form-log">
                        <p>登录</p>
                        <div class="lowin-group">
                            <label>用户名 <a href="#" class="login-back-link">登录?</a></label>
                            <input type="text" autocomplete="name" name="username" value="" class="lowin-input">
                        </div>
                        <div class="lowin-group password-group">
                            <label>密码 <a href="#" class="forgot-link">忘记密码?</a></label>
                            <input type="password" name="password" autocomplete="current-password" class="lowin-input">
                        </div>
                        <button class="lowin-btn login-btn">
							登录
						</button>

                        <div class="text-foot">
                            没有账号? <a href="./register.html" class="register-link">注册</a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <footer class="lowin-footer">

        </footer>
    </div>
    <script src="./lib/jquery.min.js"></script>
    <script src="./lib/template-web.js"></script>
    <script>
        $(function() {
            $('#form-log').on('submit', function(e) {
                e.preventDefault();
                var data = $(this).serializeArray();
                console.log(data);
                var obj = {};
                data.forEach(v => {
                    obj[v.name] = v.value;
                });
                console.log(obj);
                if (obj.username.trim() === '') {
                    alert('用户名为空');
                } else if (!/^\w{6,12}$/.test(obj.username)) {
                    alert('用户名输入不正确');
                } else if (obj.password.trim() === '') {
                    alert('密码为空');
                } else if (!/^\w{6,12}$/.test(obj.password)) {
                    alert('密码输入格式不正确')
                } else {
                    $.ajax({
                        method: 'POST',
                        url: 'http://shop.meilian.info/api/member/login',
                        data: $(this).serialize(),
                        success: function(res) {
                            if (res.code !== 2000) {
                                return res.msg;
                            }
                            localStorage.setItem('token', res.token);
                            location.href = 'goodsList.html';
                        }
                    })
                }
            })
        })
    </script>
</body>

</html>